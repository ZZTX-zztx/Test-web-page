<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>音乐播放器 合并下载</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 500px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    .btn {
      background: #0070f3;
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      width: 100%;
      margin: 1rem 0;
    }
    .btn:disabled {
      background: #999;
    }
    .log {
      background: #f5f5f5;
      padding: 1rem;
      border-radius: 8px;
      min-height: 80px;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <h1>Music Player 完整安装包</h1>
  <button class="btn" id="downloadBtn">直接合并下载</button>
  <div class="log" id="log"></div>

  <script>
    // 超简单配置，直接写死分卷地址
    const PART1 = "Music player.apk.1";
    const PART2 = "Music player.apk.2";
    const FINAL_NAME = "Music player_完整.apk";

    const btn = document.getElementById("downloadBtn");
    const log = document.getElementById("log");

    function addLog(text) {
      log.innerHTML += text + "<br>";
    }

    btn.addEventListener("click", async () => {
      btn.disabled = true;
      btn.textContent = "合并中...";
      addLog("=== 开始合并 ===");

      try {
        // 1. 直接下载两个分卷
        addLog("正在下载分卷1...");
        const res1 = await fetch(PART1);
        const buf1 = await res1.arrayBuffer();

        addLog("正在下载分卷2...");
        const res2 = await fetch(PART2);
        const buf2 = await res2.arrayBuffer();

        // 2. 直接拼接成完整APK
        addLog("正在合并分卷...");
        const total = new Uint8Array(buf1.byteLength + buf2.byteLength);
        total.set(new Uint8Array(buf1), 0);
        total.set(new Uint8Array(buf2), buf1.byteLength);
        const blob = new Blob([total], {type: "application/vnd.android.package-archive"});

        // 3. 直接触发下载
        addLog("生成完整APK...");
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = FINAL_NAME;
        a.click();
        addLog("✅ 下载完成！");
      } catch (err) {
        addLog("❌ 出错了：" + err.message);
      } finally {
        btn.disabled = false;
        btn.textContent = "重新下载";
      }
    });
  </script>
</body>
</html>
